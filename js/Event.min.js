if(typeof Event==="undefined")var Event={};
Event=function(root){root.modifyEventListener=true;root.modifySelectors=true;root.add=function(target,type,listener,configure){return eventManager(target,type,listener,configure,"add")};root.remove=function(target,type,listener,configure){return eventManager(target,type,listener,configure,"remove")};root.stop=function(event){if(event.stopPropagation)event.stopPropagation();event.cancelBubble=true;event.bubble=0};root.prevent=function(event){if(event.preventDefault)event.preventDefault();event.returnValue=
false};root.cancel=function(event){root.stop(event);root.prevent(event)};root.supports=function(target,type){if(typeof target==="string"){type=target;target=window}type="on"+type;if(type in target)return true;if(!target.setAttribute)target=document.createElement("div");if(target.setAttribute&&target.removeAttribute){target.setAttribute(type,"");var isSupported=typeof target[type]==="function";if(typeof target[type]!=="undefined")target[type]=null;target.removeAttribute(type);return isSupported}};
var eventManager=function(target,type,listener,configure,trigger,fromOverwrite){configure=configure||{};if(typeof target==="string"&&type==="ready"){var time=(new Date).getTime();var timeout=configure.timeout;var ms=configure.interval||1E3/60;var interval=setInterval(function(){if((new Date).getTime()-time>timeout)clearInterval(interval);if(document.querySelector(target)){clearInterval(interval);listener()}},ms);return}if(typeof target==="string"){target=document.querySelectorAll(target);if(target.length===
0)return createError("Missing target on listener!");if(target.length===1)target=target[0]}if(target.length>1){var events={};for(var n=0,length=target.length;n<length;n++){var event=eventManager(target[n],type,listener,configure,trigger);if(event)events[n]=event}return createBatchCommands(events)}if(type.indexOf&&type.indexOf(" ")!==-1)type=type.split(" ");if(type.indexOf&&type.indexOf(",")!==-1)type=type.split(",");if(typeof type!=="string"){var events={};if(typeof type.length==="number")for(var n=
0,length=type.length;n<length;n++){var event=eventManager(target,type[n],listener,configure,trigger);if(event)events[type[n]]=event}else for(var key in type){if(typeof type[key]==="function")var event=eventManager(target,key,type[key],configure,trigger);else var event=eventManager(target,key,type[key].listener,type[key],trigger);if(event)events[key]=event}return createBatchCommands(events)}if(typeof listener!=="function")return createError("Listener is not a function!");var useCapture=configure.useCapture||
false;var id=normalize(type)+getID(target)+"."+getID(listener)+"."+(useCapture?1:0);if(root.Gesture._gestureHandlers[type])if(trigger==="remove"){if(!wrappers[id])return;wrappers[id].remove();delete wrappers[id]}else{if(trigger==="add"){if(wrappers[id])return wrappers[id];if(configure.useCall&&!root.modifyEventListener){var tmp=listener;var listener=function(event,self){for(var key in self)event[key]=self[key];return tmp.call(target,event)}}configure.gesture=type;configure.target=target;configure.listener=
listener;configure.fromOverwrite=fromOverwrite;wrappers[id]=root.proxy[type](configure)}}else{var type=normalize(type);if(trigger==="remove"){if(!wrappers[id])return;target[remove](type,listener,useCapture);delete wrappers[id]}else if(trigger==="add"){if(wrappers[id])return wrappers[id];target[add](type,listener,useCapture);wrappers[id]={type:type,target:target,listener:listener,remove:function(){root.remove(target,type,listener,configure)}}}}return wrappers[id]};var createBatchCommands=function(events){return{remove:function(){for(var key in events)events[key].remove()},
add:function(){for(var key in events)events[key].add()}}};var createError=function(message){if(typeof console==="undefined")return;if(typeof console.error==="undefined")return;console.error(message)};var normalize=function(){var translate={};return function(type){if(!root.pointerType)if(window.navigator.msPointerEnabled){root.pointerType="mspointer";translate={"mousedown":"MSPointerDown","mousemove":"MSPointerMove","mouseup":"MSPointerUp"}}else if(root.supports("touchstart")){root.pointerType="touch";
translate={"mousedown":"touchstart","mouseup":"touchend","mousemove":"touchmove"}}else root.pointerType="mouse";if(translate[type])type=translate[type];if(!document.addEventListener)return"on"+type;else return type}}();var wrappers={};var counter=0;var getID=function(object){if(object===window)return"#window";if(object===document)return"#document";if(!object)return createError("Missing target on listener!");if(!object.uniqueID)object.uniqueID="id"+counter++;return object.uniqueID};var add=document.addEventListener?
"addEventListener":"attachEvent";var remove=document.removeEventListener?"removeEventListener":"detachEvent";root.createPointerEvent=function(event,self,preventRecord){var eventName=self.gesture;var target=self.target;var pts=event.changedTouches||root.proxy.getCoords(event);if(pts.length){var pt=pts[0];self.pointers=preventRecord?[]:pts;self.pageX=pt.pageX;self.pageY=pt.pageY;self.x=self.pageX;self.y=self.pageY}var newEvent=document.createEvent("Event");newEvent.initEvent(eventName,true,true);newEvent.originalEvent=
event;for(var k in self)newEvent[k]=self[k];target.dispatchEvent(newEvent)};if(root.modifyEventListener)(function(){var augmentEventListener=function(proto){var recall=function(trigger){var handle=trigger+"EventListener";var handler=proto[handle];proto[handle]=function(type,listener,useCapture){if(root.Gesture._gestureHandlers[type]){var configure=useCapture;if(typeof useCapture==="object")configure.useCall=true;else configure={useCall:true,useCapture:useCapture};eventManager(this,type,listener,configure,
trigger,true);handler.call(this,type,listener,useCapture)}else handler.call(this,normalize(type),listener,useCapture)}};recall("add");recall("remove")};if(navigator.userAgent.match(/Firefox/)){augmentEventListener(HTMLDivElement.prototype);augmentEventListener(HTMLCanvasElement.prototype)}else augmentEventListener(HTMLElement.prototype);augmentEventListener(document);augmentEventListener(window)})();if(root.modifySelectors)(function(){var proto=NodeList.prototype;proto.removeEventListener=function(type,
listener,useCapture){for(var n=0,length=this.length;n<length;n++)this[n].removeEventListener(type,listener,useCapture)};proto.addEventListener=function(type,listener,useCapture){for(var n=0,length=this.length;n<length;n++)this[n].addEventListener(type,listener,useCapture)}})();return root}(Event);if(typeof Event==="undefined")var Event={};if(typeof Event.proxy==="undefined")Event.proxy={};
Event.proxy=function(root){root.pointerSetup=function(conf,self){conf.doc=conf.target.ownerDocument||conf.target;conf.minFingers=conf.minFingers||conf.fingers||1;conf.maxFingers=conf.maxFingers||conf.fingers||Infinity;conf.position=conf.position||"relative";self=self||{};self.gesture=conf.gesture;self.target=conf.target;self.pointerType=Event.pointerType;if(Event.modifyEventListener&&conf.fromOverwrite)conf.listener=Event.createPointerEvent;var fingers=0;var type=self.gesture.indexOf("pointer")===
0&&Event.modifyEventListener?"pointer":"mouse";self.proxy=function(listener){self.defaultListener=conf.listener;conf.listener=listener;listener(conf.event,self)};self.remove=function(){if(conf.onPointerDown)Event.remove(conf.target,type+"down",conf.onPointerDown);if(conf.onPointerMove)Event.remove(conf.doc,type+"move",conf.onPointerMove);if(conf.onPointerUp)Event.remove(conf.doc,type+"up",conf.onPointerUp)};self.resume=function(opt){if(conf.onPointerMove&&(!opt||opt.move))Event.add(conf.doc,type+
"move",conf.onPointerMove);if(conf.onPointerUp&&(!opt||opt.move))Event.add(conf.doc,type+"up",conf.onPointerUp);conf.fingers=fingers};self.pause=function(opt){fingers=conf.fingers;if(conf.onPointerMove&&(!opt||opt.move))Event.remove(conf.doc,type+"move",conf.onPointerMove);if(conf.onPointerUp&&(!opt||opt.up))Event.remove(conf.doc,type+"up",conf.onPointerUp);conf.fingers=0};return self};root.pointerStart=function(event,self,conf){var addTouchStart=function(touch,sid){var bbox=conf.bbox;var pt=track[sid]=
{};switch(conf.position){case "absolute":pt.offsetX=0;pt.offsetY=0;break;case "difference":pt.offsetX=touch.pageX;pt.offsetY=touch.pageY;break;case "move":pt.offsetX=touch.pageX-bbox.x1;pt.offsetY=touch.pageY-bbox.y1;break;default:pt.offsetX=bbox.x1;pt.offsetY=bbox.y1;break}var x=(touch.pageX+bbox.scrollLeft-pt.offsetX)*bbox.scaleX;var y=(touch.pageY+bbox.scrollTop-pt.offsetY)*bbox.scaleY;pt.rotation=0;pt.scale=1;pt.startTime=pt.moveTime=(new Date).getTime();pt.move={x:x,y:y};pt.start={x:x,y:y};conf.fingers++};
conf.event=event;if(self.defaultListener){conf.listener=self.defaultListener;delete self.defaultListener}var isTouchStart=!conf.fingers;var track=conf.tracker;var touches=event.changedTouches||root.getCoords(event);var length=touches.length;for(var i=0;i<length;i++){var touch=touches[i];var sid=touch.identifier||Infinity;if(conf.fingers){if(conf.fingers>=conf.maxFingers){var ids=[];for(var sid in conf.tracker)ids.push(sid);self.identifier=ids.join(",");return isTouchStart}var fingers=0;for(var rid in track){if(track[rid].up){delete track[rid];
addTouchStart(touch,sid);conf.cancel=true;break}fingers++}if(track[sid])continue;addTouchStart(touch,sid)}else{track=conf.tracker={};conf.bbox=root.getBoundingBox(conf.target);conf.fingers=0;conf.cancel=false;addTouchStart(touch,sid)}}var ids=[];for(var sid in conf.tracker)ids.push(sid);self.identifier=ids.join(",");return isTouchStart};root.pointerEnd=function(event,self,conf,onPointerUp){var touches=event.touches||[];var length=touches.length;var exists={};for(var i=0;i<length;i++){var touch=touches[i];
exists[touch.identifier||Infinity]=true}for(var key in conf.tracker){var track=conf.tracker[key];if(!exists[key]&&!track.up){if(onPointerUp){event.changedTouches=[{pageX:track.pageX,pageY:track.pageY,identifier:key==="Infinity"?Infinity:key}];onPointerUp(event,"up")}conf.tracker[key].up=true;conf.fingers--}}if(conf.fingers!==0)return false;var ids=[];conf.gestureFingers=0;for(var sid in conf.tracker){conf.gestureFingers++;ids.push(sid)}self.identifier=ids.join(",");return true};root.getCoords=function(event){if(typeof event.pageX!==
"undefined")root.getCoords=function(event){return Array({type:"mouse",x:event.pageX,y:event.pageY,pageX:event.pageX,pageY:event.pageY,identifier:Infinity})};else root.getCoords=function(event){event=event||window.event;return Array({type:"mouse",x:event.clientX+document.documentElement.scrollLeft,y:event.clientY+document.documentElement.scrollTop,pageX:event.clientX+document.documentElement.scrollLeft,pageY:event.clientY+document.documentElement.scrollTop,identifier:Infinity})};return root.getCoords(event)};
root.getCoord=function(event){if("ontouchstart"in window){var pX=0;var pY=0;root.getCoord=function(event){var touches=event.changedTouches;if(touches.length)return{x:pX=touches[0].pageX,y:pY=touches[0].pageY};else return{x:pX,y:pY}}}else if(typeof event.pageX!=="undefined"&&typeof event.pageY!=="undefined")root.getCoord=function(event){return{x:event.pageX,y:event.pageY}};else root.getCoord=function(event){event=event||window.event;return{x:event.clientX+document.documentElement.scrollLeft,y:event.clientY+
document.documentElement.scrollTop}};return root.getCoord(event)};root.getBoundingBox=function(o){if(o===window||o===document)o=document.body;var bbox={x1:0,y1:0,x2:0,y2:0,scrollLeft:0,scrollTop:0};if(o===document.body){bbox.height=window.innerHeight;bbox.width=window.innerWidth}else{bbox.height=o.offsetHeight;bbox.width=o.offsetWidth}bbox.scaleX=o.width/bbox.width||1;bbox.scaleY=o.height/bbox.height||1;var tmp=o;while(tmp!==null){bbox.x1+=tmp.offsetLeft;bbox.y1+=tmp.offsetTop;tmp=tmp.offsetParent}var tmp=
o.parentNode;while(tmp!==null){if(tmp===document.body)break;if(tmp.scrollTop===undefined)break;bbox.scrollLeft+=tmp.scrollLeft;bbox.scrollTop+=tmp.scrollTop;tmp=tmp.parentNode}bbox.x2=bbox.x1+bbox.width;bbox.y2=bbox.y1+bbox.height;return bbox};root.metaTracker=function(){var agent=navigator.userAgent.toLowerCase();var mac=agent.indexOf("macintosh")!==-1;if(mac&&agent.indexOf("khtml")!==-1)var watch={91:true,93:true};else if(mac&&agent.indexOf("firefox")!==-1)var watch={224:true};else var watch={17:true};
return function(event){if(watch[event.keyCode])root.metaKey=event.type==="keydown"}}();return root}(Event.proxy);if(typeof Event==="undefined")var Event={};if(typeof Event.proxy==="undefined")Event.proxy={};
Event.proxy=function(root){root.click=function(conf){conf.maxFingers=conf.maxFingers||conf.fingers||1;var EVENT;conf.onPointerDown=function(event){if(root.pointerStart(event,self,conf)){Event.add(conf.doc,"mousemove",conf.onPointerMove).listener(event);Event.add(conf.doc,"mouseup",conf.onPointerUp)}};conf.onPointerMove=function(event){EVENT=event};conf.onPointerUp=function(event){if(root.pointerEnd(event,self,conf)){Event.remove(conf.doc,"mousemove",conf.onPointerMove);Event.remove(conf.doc,"mouseup",
conf.onPointerUp);if(EVENT.cancelBubble&&++EVENT.bubble>1)return;var pointers=EVENT.changedTouches||root.getCoords(EVENT);var pointer=pointers[0];var bbox=conf.bbox;var newbbox=root.getBoundingBox(conf.target);var ax=(pointer.pageX+bbox.scrollLeft-bbox.x1)*bbox.scaleX;var ay=(pointer.pageY+bbox.scrollTop-bbox.y1)*bbox.scaleY;if(ax>0&&ax<bbox.width&&ay>0&&ay<bbox.height&&bbox.scrollTop===newbbox.scrollTop)conf.listener(EVENT,self)}};var self=root.pointerSetup(conf);self.state="click";Event.add(conf.target,
"mousedown",conf.onPointerDown);return self};Event.Gesture=Event.Gesture||{};Event.Gesture._gestureHandlers=Event.Gesture._gestureHandlers||{};Event.Gesture._gestureHandlers.click=root.click;return root}(Event.proxy);if(typeof Event==="undefined")var Event={};if(typeof Event.proxy==="undefined")Event.proxy={};
Event.proxy=function(root){root.dbltap=root.dblclick=function(conf){conf.maxFingers=conf.maxFingers||conf.fingers||1;var delay=700;var time0,time1,timeout;var pointer0,pointer1;conf.onPointerDown=function(event){var pointers=event.changedTouches||root.getCoords(event);if(time0&&!time1){pointer1=pointers[0];time1=(new Date).getTime()-time0}else{pointer0=pointers[0];time0=(new Date).getTime();time1=0;clearTimeout(timeout);timeout=setTimeout(function(){time0=0},delay)}if(root.pointerStart(event,self,
conf)){Event.add(conf.doc,"mousemove",conf.onPointerMove).listener(event);Event.add(conf.doc,"mouseup",conf.onPointerUp)}};conf.onPointerMove=function(event){if(time0&&!time1){var pointers=event.changedTouches||root.getCoords(event);pointer1=pointers[0]}var bbox=conf.bbox;var ax=(pointer1.pageX+bbox.scrollLeft-bbox.x1)*bbox.scaleX;var ay=(pointer1.pageY+bbox.scrollTop-bbox.y1)*bbox.scaleY;if(!(ax>0&&ax<bbox.width&&ay>0&&ay<bbox.height&&Math.abs(pointer1.pageX-pointer0.pageX)<=25&&Math.abs(pointer1.pageY-
pointer0.pageY)<=25)){Event.remove(conf.doc,"mousemove",conf.onPointerMove);clearTimeout(timeout);time0=time1=0}};conf.onPointerUp=function(event){if(root.pointerEnd(event,self,conf)){Event.remove(conf.doc,"mousemove",conf.onPointerMove);Event.remove(conf.doc,"mouseup",conf.onPointerUp)}if(time0&&time1){if(time1<=delay&&!(event.cancelBubble&&++event.bubble>1)){self.state=conf.gesture;conf.listener(event,self)}clearTimeout(timeout);time0=time1=0}};var self=root.pointerSetup(conf);self.state="dblclick";
Event.add(conf.target,"mousedown",conf.onPointerDown);return self};Event.Gesture=Event.Gesture||{};Event.Gesture._gestureHandlers=Event.Gesture._gestureHandlers||{};Event.Gesture._gestureHandlers.dbltap=root.dbltap;Event.Gesture._gestureHandlers.dblclick=root.dblclick;return root}(Event.proxy);if(typeof Event==="undefined")var Event={};if(typeof Event.proxy==="undefined")Event.proxy={};
Event.proxy=function(root){root.dragElement=function(that,event){root.drag({event:event,target:that,position:"move",listener:function(event,self){that.style.left=self.x+"px";that.style.top=self.y+"px"}})};root.drag=function(conf){conf.gesture="drag";conf.onPointerDown=function(event){if(root.pointerStart(event,self,conf)){Event.add(conf.doc,"mousemove",conf.onPointerMove);Event.add(conf.doc,"mouseup",conf.onPointerUp)}conf.onPointerMove(event,"down")};conf.onPointerMove=function(event,state){var bbox=
conf.bbox;var touches=event.changedTouches||root.getCoords(event);var length=touches.length;for(var i=0;i<length;i++){var touch=touches[i];var identifier=touch.identifier||Infinity;var pt=conf.tracker[identifier];if(!pt)continue;pt.pageX=touch.pageX;pt.pageY=touch.pageY;self.state=state||"move";self.identifier=identifier;self.start=pt.start;self.fingers=1;self.x=(pt.pageX+bbox.scrollLeft-pt.offsetX)*bbox.scaleX;self.y=(pt.pageY+bbox.scrollTop-pt.offsetY)*bbox.scaleY;conf.listener(event,self)}};conf.onPointerUp=
function(event){if(root.pointerEnd(event,self,conf,conf.onPointerMove)){Event.remove(conf.doc,"mousemove",conf.onPointerMove);Event.remove(conf.doc,"mouseup",conf.onPointerUp)}};var self=root.pointerSetup(conf);if(conf.event)conf.onPointerDown(conf.event);else Event.add(conf.target,"mousedown",conf.onPointerDown);return self};Event.Gesture=Event.Gesture||{};Event.Gesture._gestureHandlers=Event.Gesture._gestureHandlers||{};Event.Gesture._gestureHandlers.drag=root.drag;return root}(Event.proxy);
if(typeof Event==="undefined")var Event={};if(typeof Event.proxy==="undefined")Event.proxy={};
Event.proxy=function(root){var RAD_DEG=Math.PI/180;root.gesture=function(conf){conf.minFingers=conf.minFingers||conf.fingers||2;conf.onPointerDown=function(event){var fingers=conf.fingers;if(root.pointerStart(event,self,conf)){Event.add(conf.doc,"mousemove",conf.onPointerMove);Event.add(conf.doc,"mouseup",conf.onPointerUp)}if(conf.fingers===conf.minFingers&&fingers!==conf.fingers){self.fingers=conf.minFingers;self.scale=1;self.rotation=0;self.state="start";var sids="";for(var key in conf.tracker)sids+=
key;self.identifier=parseInt(sids);conf.listener(event,self)}};conf.onPointerMove=function(event,state){var bbox=conf.bbox;var points=conf.tracker;var touches=event.changedTouches||root.getCoords(event);var length=touches.length;for(var i=0;i<length;i++){var touch=touches[i];var sid=touch.identifier||Infinity;var pt=points[sid];if(!pt)continue;pt.move.x=(touch.pageX+bbox.scrollLeft-bbox.x1)*bbox.scaleX;pt.move.y=(touch.pageY+bbox.scrollTop-bbox.y1)*bbox.scaleY}if(conf.fingers<conf.minFingers)return;
var touches=[];var scale=0;var rotation=0;var centroidx=0;var centroidy=0;var length=0;for(var sid in points){var touch=points[sid];if(touch.up)continue;centroidx+=touch.move.x;centroidy+=touch.move.y;length++}centroidx/=length;centroidy/=length;for(var sid in points){var touch=points[sid];if(touch.up)continue;var start=touch.start;if(!start.distance){var dx=start.x-centroidx;var dy=start.y-centroidy;start.distance=Math.sqrt(dx*dx+dy*dy);start.angle=Math.atan2(dx,dy)/RAD_DEG}var dx=touch.move.x-centroidx;
var dy=touch.move.y-centroidy;var distance=Math.sqrt(dx*dx+dy*dy);scale+=distance/start.distance;var angle=Math.atan2(dx,dy)/RAD_DEG;var rotate=(start.angle-angle+360)%360-180;touch.DEG2=touch.DEG1;touch.DEG1=rotate>0?rotate:-rotate;if(typeof touch.DEG2!=="undefined"){if(rotate>0)touch.rotation+=touch.DEG1-touch.DEG2;else touch.rotation-=touch.DEG1-touch.DEG2;rotation+=touch.rotation}touches.push(touch.move)}self.touches=touches;self.fingers=conf.fingers;self.scale=scale/conf.fingers;self.rotation=
rotation/conf.fingers;self.state="change";conf.listener(event,self)};conf.onPointerUp=function(event){var fingers=conf.fingers;if(root.pointerEnd(event,self,conf)){Event.remove(conf.doc,"mousemove",conf.onPointerMove);Event.remove(conf.doc,"mouseup",conf.onPointerUp)}if(fingers===conf.minFingers&&conf.fingers<conf.minFingers){self.fingers=conf.fingers;self.state="end";conf.listener(event,self)}};var self=root.pointerSetup(conf);Event.add(conf.target,"mousedown",conf.onPointerDown);return self};Event.Gesture=
Event.Gesture||{};Event.Gesture._gestureHandlers=Event.Gesture._gestureHandlers||{};Event.Gesture._gestureHandlers.gesture=root.gesture;return root}(Event.proxy);if(typeof Event==="undefined")var Event={};if(typeof Event.proxy==="undefined")Event.proxy={};
Event.proxy=function(root){root.pointerdown=root.pointermove=root.pointerup=function(conf){if(conf.target.isPointerEmitter)return;var isDown=true;conf.onPointerDown=function(event){isDown=false;self.gesture="pointerdown";conf.listener(event,self)};conf.onPointerMove=function(event){self.gesture="pointermove";conf.listener(event,self,isDown)};conf.onPointerUp=function(event){isDown=true;self.gesture="pointerup";conf.listener(event,self,true)};var self=root.pointerSetup(conf);Event.add(conf.target,
"mousedown",conf.onPointerDown);Event.add(conf.target,"mousemove",conf.onPointerMove);Event.add(conf.doc,"mouseup",conf.onPointerUp);conf.target.isPointerEmitter=true;return self};Event.Gesture=Event.Gesture||{};Event.Gesture._gestureHandlers=Event.Gesture._gestureHandlers||{};Event.Gesture._gestureHandlers.pointerdown=root.pointerdown;Event.Gesture._gestureHandlers.pointermove=root.pointermove;Event.Gesture._gestureHandlers.pointerup=root.pointerup;return root}(Event.proxy);
if(typeof Event==="undefined")var Event={};if(typeof Event.proxy==="undefined")Event.proxy={};
Event.proxy=function(root){root.shake=function(conf){var self={gesture:"devicemotion",acceleration:{},accelerationIncludingGravity:{},target:conf.target,listener:conf.listener,remove:function(){window.removeEventListener("devicemotion",onDeviceMotion,false)}};var threshold=4;var timeout=1E3;var timeframe=200;var shakes=3;var lastShake=(new Date).getTime();var gravity={x:0,y:0,z:0};var delta={x:{count:0,value:0},y:{count:0,value:0},z:{count:0,value:0}};var onDeviceMotion=function(e){var alpha=0.8;
var o=e.accelerationIncludingGravity;gravity.x=alpha*gravity.x+(1-alpha)*o.x;gravity.y=alpha*gravity.y+(1-alpha)*o.y;gravity.z=alpha*gravity.z+(1-alpha)*o.z;self.accelerationIncludingGravity=gravity;self.acceleration.x=o.x-gravity.x;self.acceleration.y=o.y-gravity.y;self.acceleration.z=o.z-gravity.z;if(conf.gesture==="devicemotion"){conf.listener(e,self);return}var data="xyz";var now=(new Date).getTime();for(var n=0,length=data.length;n<length;n++){var letter=data[n];var ACCELERATION=self.acceleration[letter];
var DELTA=delta[letter];var abs=Math.abs(ACCELERATION);if(now-lastShake<timeout)continue;if(abs>threshold){var idx=now*ACCELERATION/abs;var span=Math.abs(idx+DELTA.value);if(DELTA.value&&span<timeframe){DELTA.value=idx;DELTA.count++;if(DELTA.count===shakes){conf.listener(e,self);lastShake=now;DELTA.value=0;DELTA.count=0}}else{DELTA.value=idx;DELTA.count=1}}}};if(!window.addEventListener)return;window.addEventListener("devicemotion",onDeviceMotion,false);return self};Event.Gesture=Event.Gesture||{};
Event.Gesture._gestureHandlers=Event.Gesture._gestureHandlers||{};Event.Gesture._gestureHandlers.shake=root.shake;return root}(Event.proxy);if(typeof Event==="undefined")var Event={};if(typeof Event.proxy==="undefined")Event.proxy={};
Event.proxy=function(root){var RAD_DEG=Math.PI/180;root.swipe=function(conf){conf.snap=conf.snap||90;conf.threshold=conf.threshold||1;conf.onPointerDown=function(event){if(root.pointerStart(event,self,conf)){Event.add(conf.doc,"mousemove",conf.onPointerMove).listener(event);Event.add(conf.doc,"mouseup",conf.onPointerUp)}};conf.onPointerMove=function(event){var touches=event.changedTouches||root.getCoords(event);var length=touches.length;for(var i=0;i<length;i++){var touch=touches[i];var sid=touch.identifier||
Infinity;var o=conf.tracker[sid];if(!o)continue;o.move.x=touch.pageX;o.move.y=touch.pageY;o.moveTime=(new Date).getTime()}};conf.onPointerUp=function(event){if(root.pointerEnd(event,self,conf)){Event.remove(conf.doc,"mousemove",conf.onPointerMove);Event.remove(conf.doc,"mouseup",conf.onPointerUp);var velocity1;var velocity2;var degree1;var degree2;for(var sid in conf.tracker){var touch=conf.tracker[sid];var xdist=touch.move.x-touch.start.x;var ydist=touch.move.y-touch.start.y;var distance=Math.sqrt(xdist*
xdist+ydist*ydist);var ms=touch.moveTime-touch.startTime;var degree2=Math.atan2(xdist,ydist)/RAD_DEG+180;var velocity2=ms?distance/ms:0;if(typeof degree1==="undefined"){degree1=degree2;velocity1=velocity2}else if(Math.abs(degree2-degree1)<=20){degree1=(degree1+degree2)/2;velocity1=(velocity1+velocity2)/2}else return}if(velocity1>conf.threshold){self.angle=-(((degree1/conf.snap+0.5>>0)*conf.snap||360)-360);self.velocity=velocity1;self.fingers=conf.gestureFingers;self.state="swipe";conf.listener(event,
self)}}};var self=root.pointerSetup(conf);Event.add(conf.target,"mousedown",conf.onPointerDown);return self};Event.Gesture=Event.Gesture||{};Event.Gesture._gestureHandlers=Event.Gesture._gestureHandlers||{};Event.Gesture._gestureHandlers.swipe=root.swipe;return root}(Event.proxy);if(typeof Event==="undefined")var Event={};if(typeof Event.proxy==="undefined")Event.proxy={};
Event.proxy=function(root){root.tap=root.longpress=function(conf){conf.delay=conf.delay||500;conf.timeout=conf.timeout||250;var timestamp,timeout;conf.onPointerDown=function(event){if(root.pointerStart(event,self,conf)){timestamp=(new Date).getTime();Event.add(conf.doc,"mousemove",conf.onPointerMove).listener(event);Event.add(conf.doc,"mouseup",conf.onPointerUp);if(conf.gesture!=="longpress")return;timeout=setTimeout(function(){if(event.cancelBubble&&++event.bubble>1)return;var fingers=0;for(var key in conf.tracker){if(conf.tracker[key].end===
true)return;if(conf.cancel)return;fingers++}self.state="start";self.fingers=fingers;conf.listener(event,self)},conf.delay)}};conf.onPointerMove=function(event){var bbox=conf.bbox;var touches=event.changedTouches||root.getCoords(event);var length=touches.length;for(var i=0;i<length;i++){var touch=touches[i];var identifier=touch.identifier||Infinity;var pt=conf.tracker[identifier];if(!pt)continue;var x=(touch.pageX+bbox.scrollLeft-bbox.x1)*bbox.scaleX;var y=(touch.pageY+bbox.scrollTop-bbox.y1)*bbox.scaleY;
if(!(x>0&&x<bbox.width&&y>0&&y<bbox.height&&Math.abs(x-pt.start.x)<=25&&Math.abs(y-pt.start.y)<=25)){Event.remove(conf.doc,"mousemove",conf.onPointerMove);conf.cancel=true;return}}};conf.onPointerUp=function(event){if(root.pointerEnd(event,self,conf)){clearTimeout(timeout);Event.remove(conf.doc,"mousemove",conf.onPointerMove);Event.remove(conf.doc,"mouseup",conf.onPointerUp);if(event.cancelBubble&&++event.bubble>1)return;if(conf.gesture==="longpress"){if(self.state==="start"){self.state="end";conf.listener(event,
self)}return}if(conf.cancel)return;if((new Date).getTime()-timestamp>conf.timeout)return;self.state="tap";self.fingers=conf.gestureFingers;conf.listener(event,self)}};var self=root.pointerSetup(conf);Event.add(conf.target,"mousedown",conf.onPointerDown);return self};Event.Gesture=Event.Gesture||{};Event.Gesture._gestureHandlers=Event.Gesture._gestureHandlers||{};Event.Gesture._gestureHandlers.tap=root.tap;Event.Gesture._gestureHandlers.longpress=root.longpress;return root}(Event.proxy);
if(typeof Event==="undefined")var Event={};if(typeof Event.proxy==="undefined")Event.proxy={};
Event.proxy=function(root){root.wheel=function(conf){var interval;var timeout=conf.timeout||150;var count=0;var self={gesture:"wheel",state:"start",wheelDelta:0,target:conf.target,listener:conf.listener,remove:function(){conf.target[remove](type,onMouseWheel,false)}};var onMouseWheel=function(event){event=event||window.event;self.state=count++?"change":"start";self.wheelDelta=event.detail?event.detail*-20:event.wheelDelta;conf.listener(event,self);clearTimeout(interval);interval=setTimeout(function(){count=
0;self.state="end";self.wheelDelta=0;conf.listener(event,self)},timeout)};var add=document.addEventListener?"addEventListener":"attachEvent";var remove=document.removeEventListener?"removeEventListener":"detachEvent";var type=Event.supports("mousewheel")?"mousewheel":"DOMMouseScroll";conf.target[add](type,onMouseWheel,false);return self};Event.Gesture=Event.Gesture||{};Event.Gesture._gestureHandlers=Event.Gesture._gestureHandlers||{};Event.Gesture._gestureHandlers.wheel=root.wheel;return root}(Event.proxy);